<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Sola Scriptura | Holy Bible + Doctrinally Sound Resources</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3"
      crossorigin="anonymous"
    />
    <link href="style.css" rel="stylesheet" type="text/css" />
    <link href="/css/main.css" rel="stylesheet" />
    <link href="/static/scripture.css" rel="stylesheet" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Play:wght@700&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Russo+One&display=swap"
      rel="stylesheet"
    />
  </head>

  <body>
    <div class="scripture-search">
      <h1>Sola Scriptura</h1>
      <h3>Holy Bible + Doctrinally Sound Resources</h3>
      <div id="search-division">
        <form action="/form/submit" method="GET">
          <input
            type="text"
            name="text"
            class="search"
            placeholder="Search the Bible"
          />
          <input type="submit" name="submit" class="submit" value="Search" />
        </form>
      </div>
      <!--<div id="search-container" class="search-area flex">
        <button onclick="searchButton()">ðŸ”Ž</button>
        <input
          type="text"
          id="search-input"
          placeholder="ex. 'John 3:16-19' OR 'kingdom'"
          size="30"
          onkeydown="if (event.keyCode == 13) searchButton()"
        />
      </div>-->
      <div id="bbl-division">
        <div class="dropdown">
          <button
            onclick="myFunction()"
            class="dropbtn btn btn-primary"
            data-bs-toggle="modal"
            data-bs-target="#exampleModal"
          >
            Bible Book List
          </button>

          <!-- Modal -->
          <div
            class="modal fade"
            id="exampleModal"
            tabindex="-1"
            aria-labelledby="exampleModalLabel"
            aria-hidden="true"
          >
            <div class="modal-dialog">
              <div class="modal-content">
                <div class="modal-header">
                  <h5 class="modal-title" id="exampleModalLabel">
                    Modal title
                  </h5>
                  <button
                    type="button"
                    class="btn-close"
                    data-bs-dismiss="modal"
                    aria-label="Close"
                  ></button>
                </div>
                <div class="modal-body">
                  <div class="container">
                    <div class="row">
                      <!-- LEFT COL -->
                      <div class="col-6">
                        <!-- LIST OF BOOKS (probably needs a scrollable div)-->
                        <div class="listing">
                          <ul>
                            <li><a href="#anchor01">Genesis</a></li>
                            <li><a href="#anchor02">Anchor 2</a></li>
                            <li><a href="#anchor03">Anchor 3</a></li>
                            <li><a href="#anchor04">Anchor 4</a></li>
                            <li><a href="#anchor05">Anchor 5</a></li>
                          </ul>
                        </div>
                      </div>

                      <!-- RIGHT COL -->
                      <div class="col-6">
                        <!-- CONTENTS DIV, WITH ALL BOOK CHAPTERS -->
                        <div class="scrollable">
                          <a name="anchor01"></a>
                          <h6>Genesis</h6>
                          <p>
                            1 The Creation of the World <br />
                            2 The Seventh Day, God Rests <br />
                            3 The Fall <br />
                            4 Cain and Abel <br />
                            5 Adam's Descendants to Noah <br />
                            6 Increasing Corruption on Earth <br />
                            7 Go into the Ark <br />
                            8 The Flood Subsides <br />
                            9 Noah's Descendants <br />
                            10 Nations Descended from Noah <br />
                            11 The Tower of Babel <br />
                            12 The Call of Abram <br />
                            13 Abram and Lot Separate <br />
                            14 Abram Rescues Lot <br />
                            15 God's Covenant with Abram <br />
                            16 Sarai and Hagar <br />
                            17 Abraham and the Covenant of Circumcision <br />
                            18 Abraham Intercedes for Sodom <br />
                            19 God Rescues Lot <br />
                          </p>

                          <a name="anchor02"></a>
                          <h6>Anchor 2</h6>
                          <p>
                            The text is placed here....
                            <br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
                            <br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
                          </p>

                          <a name="anchor03"></a>
                          <h6>Anchor 3</h6>
                          <p>
                            The text is placed here....
                            <br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
                            <br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
                          </p>

                          <a name="anchor04"></a>
                          <h6>Anchor 4</h6>
                          <p>
                            The text is placed here....
                            <br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
                            <br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
                          </p>

                          <a name="anchor05"></a>
                          <h6>Anchor 5</h6>
                          <p>
                            The text is placed here....
                            <br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
                            <br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
                          </p>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="modal-footer">
                  <button
                    type="button"
                    class="btn btn-secondary"
                    data-bs-dismiss="modal"
                  >
                    Close
                  </button>
                  <button type="button" class="btn btn-primary">
                    Save changes
                  </button>
                </div>
              </div>
            </div>
          </div>

          <div class="subheader">
            <div class="container flex">
              <div class="subheadings">
                <h2>Select a:</h2>
                <h3 id="viewing">Bible</h3>
              </div>
              <div id="search-container" class="search-area flex">
                <button onclick="searchButton()">ðŸ”Ž</button>
                <input
                  type="text"
                  id="search-input"
                  placeholder="ex. 'John 3:16-19' OR 'kingdom'"
                  size="30"
                  onkeydown="if (event.keyCode == 13) searchButton()"
                />
              </div>
            </div>
            <!-- .container.flex -->
          </div>
          <!-- .subheader -->

          <main class="container">
            <h4 id="select-prompt" class="list-heading"><span>&nbsp;</span></h4>
            <div
              id="bible-version-list"
              class="list-container bible-list"
            ></div>
          </main>

          <!--<div id="myDropdown" class="dropdown-content">
            <div id="OT-column">
              <p>Old Testament</p>
              <div id="OT-column-scroll">
                <a href="Genesis-1.html">Genesis</a>
                <a href="Exodus-1.html">Exodus</a>
                <a href="Leviticus-1.html">Leviticus</a>
                <a href="Numbers-1.html">Numbers</a>
                <a href="Deuteronomy-1.html">Deuteronomy</a>
                <a href="Joshua-1.html">Joshua</a>
                <a href="Judges-1.html">Judges</a>
                <a href="Ruth-1.html">Ruth</a>
                <a href="1_Samuel-1.html">1 Samuel</a>
                <a href="2_Samuel-1.html">2 Samuel</a>
                <a href="">1 Kings</a>
                <a href="">2 Kings</a>
                <a href="">1 Chronicles</a>
                <a href="">2 Chronicles</a>
                <a href="">Ezra</a>
                <a href="">Nehemiah</a>
                <a href="">Esther</a>
                <a href="">Job</a>
                <a href="">Psalm</a>
                <a href="">Proverbs</a>
                <a href="">Ecclesiastes</a>
                <a href="">Song of Solomon</a>
                <a href="">Isaiah</a>
                <a href="">Jeremiah</a>
                <a href="">Lamentations</a>
                <a href="">Ezekiel</a>
                <a href="">Daniel</a>
                <a href="">Hosea</a>
                <a href="">Joel</a>
                <a href="">Amos</a>
                <a href="">Obadiah</a>
                <a href="">Micah</a>
                <a href="">Nahum</a>
                <a href="">Habbakuk</a>
                <a href="">Zephaniah</a>
                <a href="">Haggai</a>
                <a href="">Zechariah</a>
                <a href="">Malachi</a>
              </div>
            </div>
            <div id="NT-column">
              <p>New Testament</p>
              <div id="NT-column-scroll">
                <a href="Matthew-1.html">Matthew</a>
                <a href="Mark-1.html">Mark</a>
                <a href="Luke-1.html">Luke</a>
                <a href="John-1.html">John</a>
                <a href="Acts-1.html">Acts</a>
                <a href="Romans-1.html">Romans</a>
                <a href="1_Corinthians-1.html">1 Corinthians</a>
                <a href="2_Corinthians-1.html">2 Corinthians</a>
                <a href="Galatians-1.html">Galatians</a>
                <a href="Ephesians-1.html">Ephesians</a>
                <a href="">Philippians</a>
                <a href="">Colossians</a>
                <a href="">1 Thessalonians</a>
                <a href="">2 Thessalonians</a>
                <a href="">1 Timothy</a>
                <a href="">2 Timothy</a>
                <a href="">Titus</a>
                <a href="">Philemon</a>
                <a href="">Hebrews</a>
                <a href="">James</a>
                <a href="">1 Peter</a>
                <a href="">2 Peter</a>
                <a href="">1 John</a>
                <a href="">2 John</a>
                <a href="">3 John</a>
                <a href="">Jude</a>
                <a href="">Revelation</a>
              </div>
            </div>
            <div id="S-column">
              <p>Summary</p>
              <div id="S-column-scroll">
                <a href="Genesis-1.html">1 The Creation of the World</a>
                <a href="Exodus-1.html">2 The Seventh Day, God Rests</a>
                <a href="Leviticus-1.html">3 The Fall</a>
                <a href="Numbers-1.html">4 Cain and Abel</a>
                <a href="Deuteronomy-1.html">5 Adam's Descendants to Noah</a>
                <a href="Joshua-1.html">6 Increasing Corruption on Earth</a>
                <a href="Judges-1.html">Judges</a>
                <a href="Ruth-1.html">Ruth</a>
                <a href="1_Samuel-1.html">1 Samuel</a>
                <a href="2_Samuel-1.html">2 Samuel</a>
              </div>
            </div>
          </div>-->
        </div>
      </div>
    </div>

    <script src="script.js"></script>
    <script src="../js/my_key.js"></script>
    <script>
      const versionList = document.querySelector(`#bible-version-list`);
      let versionHTML = ``;
      getBibleVersions().then((bibleVersionList) => {
        const sortedVersions = sortVersionsByLanguage(bibleVersionList);

        for (let languageGroup in sortedVersions) {
          const language = languageGroup;
          versionHTML += `<h4 class="list-heading"><span>${language}</span></h4><ul>`;
          const versions = sortedVersions[languageGroup];
          for (let version of versions) {
            versionHTML += `<li class="bible">
                              <a href="book.html?version=${version.id}&abbr=${
              version.abbreviation
            }">
                                <abbr class="bible-version-abbr" title="${
                                  version.name
                                }">${version.abbreviation}</abbr>
                                <span>
                                  <span class="bible-version-name">${
                                    version.name
                                  }</span>
                                  ${
                                    version.description
                                      ? '<span class="bible-version-desc">' +
                                        version.description +
                                        "</span>"
                                      : ""
                                  }
                                </span>
                              </a>
                            </li>`;
          }
          versionHTML += `</ul>`;
        }
        versionList.innerHTML = versionHTML;
      });

      /**
       * Gets Bible versions from API.Bible
       * @returns {Promise} containing list of Bible versions
       */
      function getBibleVersions() {
        return new Promise((resolve, reject) => {
          const xhr = new XMLHttpRequest();
          xhr.withCredentials = false;

          xhr.addEventListener(`readystatechange`, function () {
            if (this.readyState === this.DONE) {
              const { data } = JSON.parse(this.responseText);
              const versions = data.map((data) => {
                return {
                  name: data.name,
                  id: data.id,
                  abbreviation: data.abbreviation,
                  description: data.description,
                  language: data.language.name,
                };
              });

              resolve(versions);
            }
          });

          xhr.open(`GET`, `https://api.scripture.api.bible/v1/bibles`);
          xhr.setRequestHeader(`api-key`, API_KEY);

          xhr.onerror = () => reject(xhr.statusText);

          xhr.send();
        });
      }

      /**
       * Sorts Bible versions by language and alphabetically by abbreviation
       * @params {Object} bibleVersionList list of Bible versions
       * @returns {Object} sorted list of Bibles
       */
      function sortVersionsByLanguage(bibleVersionList) {
        let sortedVersions = {};

        for (const version of bibleVersionList) {
          if (!sortedVersions[version.language]) {
            sortedVersions[version.language] = [];
          }
          sortedVersions[version.language].push(version);
        }
        for (const version in sortedVersions) {
          sortedVersions[version].sort((a, b) => {
            const nameA = a.abbreviation.toUpperCase();
            const nameB = b.abbreviation.toUpperCase();
            if (nameA < nameB) {
              return -1;
            }
            if (nameA > nameB) {
              return 1;
            }
            return 0;
          });
        }
        return sortedVersions;
      }
    </script>

    <script
      src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.10.2/dist/umd/popper.min.js"
      integrity="sha384-7+zCNj/IqJ95wo16oMtfsKbZ9ccEh31eOz1HGyDuCQ6wgnyJNSYdrPa03rtR1zdB"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js"
      integrity="sha384-QJHtvGhmr9XOIpI6YVutG+2QOK9T+ZnN4kzFN1RtK3zEFEIsxhlmWl5/YESvpZ13"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
